---
title: taro小程序
date: '2021-11-15'
sidebar: 'auto'
categories:
 - javascript
tags:
 - taro
publish: true
---

## 小程序分包
- 整个小程序所有分包大小不超过 16M（主包 + 所有分包）
- 单个分包/主包大小不能超过 2M
- tabBar 页面需要放到主包
- 当用户进入分包内某个页面时，客户端会把对应分包下载下来，下载完成后再进行展示
- 非 tabBar 页面可以按照功能的不同，划分为不同的分包之后，进行按需下载

### 独立分包和普通分包的区别
- 普通分包必须依赖于主包才能运行
- 独立分包可以在不下载主包的情况下，独立运行

### 独立分包的应用场景
- 当小程序从普通的分包页面启动时，需要首先下载主包
- 而独立分包不依赖主包即可运行，可以很大程度上提升分包页面的启动速度
- 在分包配置independent: true即是独立分包

### 分包预下载
> 分包预下载指的是：在进入小程序的某个页面时，由框架自动预下载可能需要的分包，从而提升进入后续分包页面时的启动速度s
> 预下载分包的行为，会在进入指定的页面时触发。在 app.json 中，使用 preloadRule 节点定义分包的预下载
```json
 "preloadRule": {
    "pages/contact/contact": {
      "packages": [
        "p1"
      ],
      "network": "wifi"//network有“all”和“wifi”可以选
    }
  },
```
> 同一个分包中的页面享有共同的预下载大小限额 2M，限额会在工具中打包时校验。